<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=utf8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Syntaxerr.html">
<link rel="next" href="Arg_helper.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Compiler_libs" rel="Chapter" href="Compiler_libs.html">
<link title="Ast_helper" rel="Chapter" href="Ast_helper.html">
<link title="Ast_invariants" rel="Chapter" href="Ast_invariants.html">
<link title="Ast_iterator" rel="Chapter" href="Ast_iterator.html">
<link title="Ast_mapper" rel="Chapter" href="Ast_mapper.html">
<link title="Asttypes" rel="Chapter" href="Asttypes.html">
<link title="Attr_helper" rel="Chapter" href="Attr_helper.html">
<link title="Builtin_attributes" rel="Chapter" href="Builtin_attributes.html">
<link title="CamlinternalMenhirLib" rel="Chapter" href="CamlinternalMenhirLib.html">
<link title="Depend" rel="Chapter" href="Depend.html">
<link title="Docstrings" rel="Chapter" href="Docstrings.html">
<link title="Lexer" rel="Chapter" href="Lexer.html">
<link title="Location" rel="Chapter" href="Location.html">
<link title="Longident" rel="Chapter" href="Longident.html">
<link title="Parse" rel="Chapter" href="Parse.html">
<link title="Parser" rel="Chapter" href="Parser.html">
<link title="Parsetree" rel="Chapter" href="Parsetree.html">
<link title="Pprintast" rel="Chapter" href="Pprintast.html">
<link title="Printast" rel="Chapter" href="Printast.html">
<link title="Syntaxerr" rel="Chapter" href="Syntaxerr.html">
<link title="Unit_info" rel="Chapter" href="Unit_info.html">
<link title="Arg_helper" rel="Chapter" href="Arg_helper.html">
<link title="Binutils" rel="Chapter" href="Binutils.html">
<link title="Build_path_prefix_map" rel="Chapter" href="Build_path_prefix_map.html">
<link title="Ccomp" rel="Chapter" href="Ccomp.html">
<link title="Clflags" rel="Chapter" href="Clflags.html">
<link title="Compression" rel="Chapter" href="Compression.html">
<link title="Config" rel="Chapter" href="Config.html">
<link title="Config_boot" rel="Chapter" href="Config_boot.html">
<link title="Config_main" rel="Chapter" href="Config_main.html">
<link title="Consistbl" rel="Chapter" href="Consistbl.html">
<link title="Diffing" rel="Chapter" href="Diffing.html">
<link title="Diffing_with_keys" rel="Chapter" href="Diffing_with_keys.html">
<link title="Domainstate" rel="Chapter" href="Domainstate.html">
<link title="Format_doc" rel="Chapter" href="Format_doc.html">
<link title="Identifiable" rel="Chapter" href="Identifiable.html">
<link title="Int_replace_polymorphic_compare" rel="Chapter" href="Int_replace_polymorphic_compare.html">
<link title="Lazy_backtrack" rel="Chapter" href="Lazy_backtrack.html">
<link title="Linkdeps" rel="Chapter" href="Linkdeps.html">
<link title="Load_path" rel="Chapter" href="Load_path.html">
<link title="Local_store" rel="Chapter" href="Local_store.html">
<link title="Misc" rel="Chapter" href="Misc.html">
<link title="Numbers" rel="Chapter" href="Numbers.html">
<link title="Profile" rel="Chapter" href="Profile.html">
<link title="Strongly_connected_components" rel="Chapter" href="Strongly_connected_components.html">
<link title="Targetint" rel="Chapter" href="Targetint.html">
<link title="Terminfo" rel="Chapter" href="Terminfo.html">
<link title="Warnings" rel="Chapter" href="Warnings.html">
<link title="Pparse" rel="Chapter" href="Pparse.html"><link title="Module name convention and computation" rel="Section" href="#modname_from_strings">
<link title="Metadata for compilation unit" rel="Section" href="#unit_info">
<link title="Derived build artifact metadata" rel="Section" href="#info_build_artifacts">
<link title="Mli and cmi derived from implementation files " rel="Section" href="#ml_mli_cmi_interaction">
<link title="Module name validation function" rel="Subsection" href="#module_name_validation">
<title>OCaml compiler library : Unit_info</title>
</head>
<body>
<h1>Module <a href="type_Unit_info.html">Unit_info</a></h1>

<pre><span id="MODULEUnit_info"><span class="keyword">module</span> Unit_info</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Unit_info.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>This module centralize the handling of compilation files and their metadata.</p>

<p>Maybe more importantly, this module provides functions for deriving module
  names from strings or filenames.</p>
</div>
</div>
<hr width="100%">
<h2 id="modname_from_strings">Module name convention and computation</h2>
<pre><span id="TYPEmodname"><span class="keyword">type</span> <code class="type"></code>modname</span> = <code class="type">string</code> </pre>


<pre><span id="TYPEfilename"><span class="keyword">type</span> <code class="type"></code>filename</span> = <code class="type">string</code> </pre>


<pre><span id="TYPEfile_prefix"><span class="keyword">type</span> <code class="type"></code>file_prefix</span> = <code class="type">string</code> </pre>


<pre><span id="VALmodulize"><span class="keyword">val</span> modulize</span> : <code class="type">string -&gt; <a href="Unit_info.html#TYPEmodname">modname</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">modulize&nbsp;s</code> capitalizes the first letter of <code class="code">s</code>.</p>
</div>
</div>

<pre><span id="VALnormalize"><span class="keyword">val</span> normalize</span> : <code class="type">string -&gt; string</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">normalize&nbsp;s</code> uncapitalizes the first letter of <code class="code">s</code>.</p>
</div>
</div>

<pre><span id="VALmodname_from_source"><span class="keyword">val</span> modname_from_source</span> : <code class="type"><a href="Unit_info.html#TYPEfilename">filename</a> -&gt; <a href="Unit_info.html#TYPEmodname">modname</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">modname_from_source&nbsp;filename</code> is <code class="code">modulize&nbsp;stem</code> where <code class="code">stem</code> is the
    basename of the filename <code class="code">filename</code> stripped from all its extensions.
    For instance, <code class="code">modname_from_source&nbsp;<span class="string">"/pa.th/x.ml.pp"</span></code> is <code class="code"><span class="string">"X"</span></code>.</p>
</div>
</div>
<h3 id="module_name_validation">Module name validation function</h3>
<pre><span id="VALis_unit_name"><span class="keyword">val</span> is_unit_name</span> : <code class="type"><a href="Unit_info.html#TYPEmodname">modname</a> -&gt; bool</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">is_unit_name&nbsp;~strict&nbsp;name</code> is true only if <code class="code">name</code> can be used as a
    valid module name.</p>
</div>
</div>
<h2 id="unit_info">Metadata for compilation unit</h2>
<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type"></code>t</span> </pre>
<div class="info ">
<div class="info-desc">
<p>Metadata for a compilation unit:</p>
<ul>
<li>the module name associated to the unit</li>
<li>the filename prefix (dirname + basename with all extensions stripped)
      for compilation artifacts</li>
<li>the input source file
    For instance, when calling <code class="code">ocamlopt&nbsp;dir/x.mli&nbsp;-o&nbsp;target/y.cmi</code>,</li>
<li>the input source file is <code class="code">dir/x.mli</code></li>
<li>the module name is <code class="code"><span class="constructor">Y</span></code></li>
<li>the prefix is <code class="code">target/y</code></li>
</ul>
</div>
</div>


<pre><span id="VALsource_file"><span class="keyword">val</span> source_file</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.html#TYPEfilename">filename</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">source_file&nbsp;u</code> is the source file of <code class="code">u</code>.</p>
</div>
</div>

<pre><span id="VALprefix"><span class="keyword">val</span> prefix</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.html#TYPEfile_prefix">file_prefix</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">prefix&nbsp;u</code> is the filename prefix of the unit.</p>
</div>
</div>

<pre><span id="VALmodname"><span class="keyword">val</span> modname</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.html#TYPEmodname">modname</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">modname&nbsp;u</code> or <code class="code">artifact_modname&nbsp;a</code> is the module name of the unit
    or compilation artifact.</p>
</div>
</div>

<pre><span id="VALcheck_unit_name"><span class="keyword">val</span> check_unit_name</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">check_unit_name&nbsp;u</code> prints a warning if the derived module name <code class="code">modname&nbsp;u</code>
    should not be used as a module name as specified
    by <a href="Unit_info.html#VALis_unit_name"><code class="code"><span class="constructor">Unit_info</span>.is_unit_name</code></a><code class="code">&nbsp;~strict:<span class="keyword">true</span></code>.</p>
</div>
</div>

<pre><span id="VALmake"><span class="keyword">val</span> make</span> : <code class="type">?check_modname:bool -&gt;<br>       source_file:<a href="Unit_info.html#TYPEfilename">filename</a> -&gt; <a href="Unit_info.html#TYPEfile_prefix">file_prefix</a> -&gt; <a href="Unit_info.html#TYPEt">t</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">make&nbsp;~check&nbsp;~source_file&nbsp;prefix</code> associates both the
    <code class="code">source_file</code> and the module name <a href="Unit_info.html#VALmodname_from_source"><code class="code"><span class="constructor">Unit_info</span>.modname_from_source</code></a><code class="code">&nbsp;target_prefix</code> to
    the prefix filesystem path <code class="code">prefix</code>.</p>

<p>If <code class="code">check_modname=<span class="keyword">true</span></code>, this function emits a warning if the derived module
   name is not valid according to <a href="Unit_info.html#VALcheck_unit_name"><code class="code"><span class="constructor">Unit_info</span>.check_unit_name</code></a>.</p>
</div>
</div>

<pre><span id="MODULEArtifact"><span class="keyword">module</span> <a href="Unit_info.Artifact.html">Artifact</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Unit_info.Artifact.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Build artifacts</p>

</div>
<h2 id="info_build_artifacts">Derived build artifact metadata</h2>
<pre><span id="VALcmi"><span class="keyword">val</span> cmi</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Those functions derive a specific <code class="code">artifact</code> metadata from an <code class="code">unit</code>
    metadata.</p>
</div>
</div>

<pre><span id="VALcmo"><span class="keyword">val</span> cmo</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre>
<pre><span id="VALcmx"><span class="keyword">val</span> cmx</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre>
<pre><span id="VALobj"><span class="keyword">val</span> obj</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre>
<pre><span id="VALcmt"><span class="keyword">val</span> cmt</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre>
<pre><span id="VALcmti"><span class="keyword">val</span> cmti</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre>
<pre><span id="VALannot"><span class="keyword">val</span> annot</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre>
<pre><span id="VALcompanion_obj"><span class="keyword">val</span> companion_obj</span> : <code class="type"><a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>The functions below change the type of an artifact by updating the
    extension of its filename.
    Those functions purposefully do not cover all artifact kinds because we want
    to track which artifacts are assumed to be bundled together.</p>
</div>
</div>

<pre><span id="VALcompanion_cmt"><span class="keyword">val</span> companion_cmt</span> : <code class="type"><a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre>
<pre><span id="VALcompanion_cmi"><span class="keyword">val</span> companion_cmi</span> : <code class="type"><a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Beware that <code class="code">companion_cmi&nbsp;a</code> strips all extensions from the
 filename of <code class="code">a</code> before adding the <code class="code"><span class="string">".cmi"</span></code> suffix contrarily to
 the other functions which only remove the rightmost extension.
 In other words, the companion cmi of a file <code class="code">something.d.cmo</code> is
 <code class="code">something.cmi</code> and not <code class="code">something.d.cmi</code>.</p>
</div>
</div>
<h2 id="ml_mli_cmi_interaction">Mli and cmi derived from implementation files </h2><p>The compilation of module implementation changes in presence of mli and cmi
    files, the function belows help to handle this.</p>

<pre><span id="VALmli_from_source"><span class="keyword">val</span> mli_from_source</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.html#TYPEfilename">filename</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">mli_from_source&nbsp;u</code> is the interface source filename associated to the unit
    <code class="code">u</code>. The actual suffix depends on <a href="Config.html#VALinterface_suffix"><code class="code"><span class="constructor">Config</span>.interface_suffix</code></a>.</p>
</div>
</div>

<pre><span id="VALmli_from_artifact"><span class="keyword">val</span> mli_from_artifact</span> : <code class="type"><a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a> -&gt; <a href="Unit_info.html#TYPEfilename">filename</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">mli_from_artifact&nbsp;t</code> is the name of the interface source file derived from
    the artifact <code class="code">t</code>. This variant is necessary when handling artifacts derived
    from an unknown source files (e.g. packed modules).</p>
</div>
</div>

<pre><span id="VALis_cmi"><span class="keyword">val</span> is_cmi</span> : <code class="type"><a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a> -&gt; bool</code></pre><div class="info ">
<div class="info-desc">
<p>Check if the artifact is a cmi</p>
</div>
</div>

<pre><span id="VALfind_normalized_cmi"><span class="keyword">val</span> find_normalized_cmi</span> : <code class="type"><a href="Unit_info.html#TYPEt">t</a> -&gt; <a href="Unit_info.Artifact.html#TYPEt">Artifact.t</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">find_normalized_cmi&nbsp;u</code> finds in the load_path a file matching the module
    name <code class="code">modname&nbsp;u</code>.</p>
</div>
<ul class="info-attributes">
<li><b>Raises</b> <code>Not_found</code> if no such cmi exists</li>
</ul>
</div>
</body></html>
